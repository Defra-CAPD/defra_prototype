/**
 * --------------------------------------------------------------------
 * jQuery tabs plugin
 * Author: Scott Jehl, scott@filamentgroup.com
 * Copyright (c) 2009 Filament Group
 * licensed under MIT (filamentgroup.com/examples/mit-license.txt)
 * --------------------------------------------------------------------
 */
jQuery.fn.tabs=function(e){var a=$.extend({trackState:!1,srcPath:"jQuery.history.blank.html",autoRotate:!1,alwaysScrollToTop:!0,selected:null,wrapperTag:"section",defaultTab:null,containerTag:"div",scrollOnload:!1},e),t="tabset",n=function(e){var n=t,r=e.closest(a.containerTag);return r.hasClass("programme-progression")?"none"===e.closest(a.containerTag).css("float")&&(n="accordion"):"none"===e.find("li").css("float")&&(n="accordion"),"accordion"===n?null===a.defaultTab&&(a.defaultTab=-1):null===a.defaultTab&&(a.defaultTab=0),n},r=function(e,a){return"accordion"===t?e.find("header.js-heading-tab"):a.find("li")},i=function(e,t){var n,r,i,s=t.find("li"),d=t.closest(a.containerTag).parent();$.each(s,function(){var e=$(this).find("a"),t=e.attr("href").split("#")[1],s=$('<a href="#'+t+'" class="tab-shiftlink">Return to top of section \u2191</a>');n=d.find("#"+t),r=n.find("header"),r=r.length?r.remove():$("<header><h1 /></header>"),r.addClass("js-heading-tab").removeClass("visuallyhidden"),r.children().html("").append(e),i=n.find(".inner"),i.length?i.addClass("tabs-pane"):i=$('<div class="inner tabs-pane" />').html(n.html()),i.attr("id",t),n.replaceWith($("<"+a.wrapperTag+" />").append(i)),n=i.parent(),n.prepend(r).attr("id",t),n.addClass("js-tab-container"),i.append(s)}),t.closest(a.containerTag).remove()};return $(this).each(function(){function e(e,n){if(a.trackState&&!n){var r=e.attr("href").split("#")[1];$.historyLoad(r)}else{u.find("a").attr("aria-selected",!1).attr("tabindex",-1),"accordion"===t?u.find("a").closest(".js-heading-tab").removeClass("active"):u.find("a").parent().filter(".active").removeClass("active"),e.attr("aria-selected",!0).attr("tabindex",0),"accordion"===t?e.closest(".js-heading-tab").addClass("active"):e.parent().addClass("active"),c.find(".tabs-panel-selected").attr("aria-hidden",!0).attr("aria-expanded",!1).removeClass("tabs-panel-selected").hide();var r=e.attr("href").split("#")[1];$("#"+r+h).addClass("tabs-panel-selected").attr("aria-hidden",!1).attr("aria-expanded",!0).show(),a.selected=u.find("a").index(e),o.trigger("tabChanged",r)}}function s(){u.find("a").attr("aria-selected",!1).attr("tabindex",-1),u.find("a").closest(".js-heading-tab").removeClass("active"),c.find(".tabs-panel-selected").attr("aria-hidden",!0).attr("aria-expanded",!1).removeClass("tabs-panel-selected").hide()}function d(t,n){var r=t||window.location.hash;0==r.indexOf("#")&&(r=r.split("#")[1]);var i=u.find("a[href$=#"+r+"]");return i.size()>0?(e(i,!0),a.scrollOnload&&n&&window.setTimeout(function(){$(document).scrollTop(i.offset().top)},0)):a.defaultTab>-1&&e(u.find("a").eq(a.defaultTab),!0),!!i.size()}var o=$(this),l=o.find(".tabs-nav ul, .tabs-nav ol");if(0===l.length)return o;var c=$(".tabs-content"),f="tab-",h="-enhanced";c.addClass("tabs-body").attr("aria-live","polite"),t=n(l),"accordion"===t?i(o,l):l.addClass("tabs-nav").attr("role","tablist"),c.find(".tabs-panel").each(function(){$(this).addClass("tabs-panel").attr("role","tabpanel").attr("aria-hidden",!0).attr("aria-expanded",!1).attr("aria-labelledby",f+$(this).attr("id")).attr("id",$(this).attr("id")+h).hide()});var u=r(c,l);u.find("a").each(function(){var e=$(this).attr("href").split("#")[1];$(this).attr("role","tab").attr("id",f+e).attr("aria-controls",e).attr("aria-flowto",e)}),o.on("keydown",function(e){if(!(e.keyCode<$.ui.keyCode.PAGE_UP||e.keyCode>$.ui.keyCode.DOWN)){var t,n;switch(e.keyCode){case $.ui.keyCode.RIGHT:e.preventDefault(),t=a.selected+1;break;case $.ui.keyCode.DOWN:t=a.selected+1;break;case $.ui.keyCode.UP:t=a.selected-1;break;case $.ui.keyCode.LEFT:t=a.selected-1;break;case $.ui.keyCode.END:t=u.length-1;break;case $.ui.keyCode.HOME:t=0;break;case $.ui.keyCode.PAGE_UP:if(!e.ctrlKey)return;t=a.selected+1;break;case $.ui.keyCode.PAGE_DOWN:if(!e.ctrlKey)return;if(t=a.selected+1,!e.ctrlKey)return;t=a.selected-1}return e.preventDefault(),e.stopPropagation(),void 0!==t&&(t=t>=u.length?0:0>t?u.length-1:t,n=u.find("a").eq(t),n.focus(),a.selected=t),!1}}),o.bind("click keydown focus",function(){a.autoRotate&&clearInterval(tabRotator)}),a.trackState&&$.historyInit(d,a.srcPath),d(null,!0),u.on("click","a",function(){return $(this).closest(".js-heading-tab").hasClass("active")?s($(this)):e($(this)),$(this).focus(),!1}),a.alwaysScrollToTop&&$(window)[0].scrollTo(0,0),"undefined"!=typeof GOVUK.stopScrollingAtFooter&&GOVUK.stopScrollingAtFooter.updateFooterTop()})};